# VisualSoar Feature Specification (for Reimplementation)

> [!note]
> This document was created by AI based on the VisualSoar manual.

This document summarizes the functional feature set of VisualSoar, extracted and
reformulated for implementation in a new architecture or programming language.

## Core Features

### **1. Project Management**

- Create new Soar projects (`.vsa`)
- Open existing projects
- Save and "Save As"
- Single project open per application instance (but multiple instances allowed)
- Automatic project scaffolding including:
  - Root `.soar` file
  - `_firstload.soar`, `_source.soar`
  - `elaborations/`, `all/`, and operator folders

## Soar Source Editing (Rule Editor)

- Syntax highlighting for Soar language
- Auto-formatting and indentation rules
- Comment/uncomment toggle
- Autocomplete using datamap context ("Soar Complete")
  - Triggered manually and on `.`
- Error checking:
  - Syntax errors
  - Datamap consistency validation
- Multiple editor windows
- Support for opening arbitrary non-project text files
- User-defined template insertion
  - Built-in templates
  - Custom templates with macros
- Editor preferences including font size and highlighting configuration

## Operator Hierarchy Management

- Visual hierarchical UI representing Soar operator structure
- Tree nodes synced with file system layout
- Node operations:
  - Add high/low-level operators
  - Add impasse folders (tie, conflict, constraint failure, no-change)
  - Add `.soar` code files
  - Rename nodes (non-destructive to code)
  - Delete nodes and subtrees (removes associated files)
  - Import/export nodes as `.vse` packages
  - Find/replace text in subtree scope
- Double-click to open associated editor

## Datamap System

### Datamap Model & View

- Tree-based structure representing allowed WMEs
- Inheritance via `superstate` links
- Supports recursive references via linking

### Datamap Editing

- Add attribute/value types:
  - Identifier
  - Integer (with optional range)
  - Float (with optional range)
  - Enumeration (constrained symbolic set)
  - String
- Edit/rename/remove nodes
- Comments attached to nodes
- Drag-and-drop to reorganize structure
- Create linked references via keyboard-multimodifier drag (supports shared structure)

### Automation & Verification

- Generate datamap entries from productions (per file or entire project)
- Highlight unvalidated entries (green)
- Validate individual or all entries
- Remove autogenerated entries
- Datamap semantic checks:
  - Missing attribute definitions
  - Type mismatches (e.g., integer vs string)
  - Out-of-range values
  - Unsupported enumerations

### Datamap Search Tools

- Search by attribute name
- Locate productions tied to datamap nodes

## Search and Navigation

- Global find and replace across all project files
- List all productions
- Context-aware search in datamap and operator hierarchy

## Debugger Interface / Runtime Tools

_(Requires Soar Java Debugger and SML connectivity)_

- Connect/disconnect from running Soar agents
- Send project files to agent (reload all)
- Execute arbitrary debugger console commands
- Switch active agent when multiple agents exist

## Preferences and UI Behavior

- Window tiling layout management
- Tile orientation options (horizontal/vertical)
- Enable/disable:
  - Syntax highlighting
  - Auto-formatting
  - Autocomplete behavior
- Customizable syntax highlight colors
- Font adjustment
- Partial persistence of preferences (not all survive restart in legacy version)

## Command Line Support

- Launch via: `java -jar VisualSoar.jar`
- Optional command-line project open argument
- Startup validation for required libraries (`sml.jar`, `swt.jar`, native runtime libs)

## File Types Used and Maintained

| File Type      | Purpose                             |
| -------------- | ----------------------------------- |
| `.vsa`         | Project configuration               |
| `.soar`        | Production source files             |
| `_source.soar` | Auto-loading glue file              |
| `.dm`          | Datamap definitions                 |
| `.vse`         | Export format for operator subtrees |

## Components for Implementation

| Module                | Responsibility                                 |
| --------------------- | ---------------------------------------------- |
| Project Manager       | Project storage and structure generation       |
| Rule Editor System    | Parsing, highlighting, validation, templates   |
| Operator Hierarchy UI | Tree visualization, import/export, linking     |
| Datamap Engine        | Graph model, editing, validation               |
| Runtime Connector     | Soar SML communication and interaction         |
| Search and Indexing   | Cross-file text search and production indexing |
| UI + Preferences      | Layout, windowing, user preference persistence |
